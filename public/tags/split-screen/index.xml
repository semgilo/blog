<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>split-screen on 蓝胡子</title>
    <link>http://www.lanhuzi.com/tags/split-screen/</link>
    <description>Recent content in split-screen on 蓝胡子</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sat, 09 Jan 2021 14:32:00 +0800</lastBuildDate><atom:link href="http://www.lanhuzi.com/tags/split-screen/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>android 分屏适配</title>
      <link>http://www.lanhuzi.com/android_split_screen_adaptation/</link>
      <pubDate>Sat, 09 Jan 2021 14:32:00 +0800</pubDate>
      
      <guid>http://www.lanhuzi.com/android_split_screen_adaptation/</guid>
      <description>问题描述 由于 android 可以开启分屏和华为的折叠屏导致游戏适配问题
问题分析 官方文档 android 7.0 开始支持 multi-windows android 8.0 支持画中画 多窗口模式不会更改 Activity 生命周期 适配标识 android:resizeableActivity 画中画支持 android:supportsPictureInPicture 配置更改 android:configChanges=&amp;ldquo;screenSize|smallestScreenSize|screenLayout|orientation&amp;rdquo; 判断方法 // Activity 提供以下方法来支持多窗口显示。 isInMultiWindowMode() // 调用该方法可确认 Activity 是否处于多窗口模式。 isInPictureInPictureMode() 生命周期 onMultiWindowModeChanged() onPictureInPictureModeChanged() Cocos2d-x 的 GlView 创建流程 Cocos2dxActivity -&amp;gt; Cocos2dxGLSurfaceView -&amp;gt; Cocos2dxRender -&amp;gt; GLView
当屏幕尺寸发生改变的 Cocos2dxGLSurfaceView -&amp;gt; Cocos2dxRender -&amp;gt; GLView
需要处理的问题 当窗口大小发生改变的时候不重新创建OpenGLView 窗口大小改变的事件传递 java -&amp;gt; c++ -&amp;gt; lua 窗口大小改变后点击事件位置适配问题 窗口大小改变后游戏界面的适配 解决方案 在AndroidManifest.xml添加下列参数，让OpenGLView不因为调整大小而重建 // android:configChanges &amp;#34;smallestScreenSize|density|screenLayout&amp;#34; 传递尺寸更改信息 // cocos/client/platform/android/javaactivity-android.cpp void Java_org_cocos2dx_lib_Cocos2dxRenderer_nativeOnSurfaceChanged(JNIEnv* env, jobject thiz, jint w, jint h) { cocos2d::Application::getInstance()-&amp;gt;applicationScreenSizeChanged(w, h); }  传递给lua  void AppDelegate::applicationScreenSizeChanged(int newWidth, int newHeight) { // .</description>
    </item>
    
  </channel>
</rss>
